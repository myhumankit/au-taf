CMAKE_MINIMUM_REQUIRED(VERSION 3.15)

SET (CMAKE_C_COMPILER_WORKS 1)
SET (CMAKE_CXX_COMPILER_WORKS 1)

if ( USE_STM32F4_AS_SUBMODULE STREQUAL "YES" )
  SET( STM32F4_SOURCE_DIR ${BASE_STM32F4_SOURCE_DIR} )
else()
  SET( STM32F4_SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR} )
endif()


SET(PLATFORM_NAME STM32F429I-Discovery)
INCLUDE( ${STM32F4_SOURCE_DIR}/Config/stm32f4.cmake )
INCLUDE( ${STM32F4_SOURCE_DIR}/Config/stm32f429.cmake )

if ( NOT USE_STM32F4_AS_SUBMODULE STREQUAL "YES" )
  PROJECT(stm32)
endif()

SET (STM32F4_HAL_DRIVER_SOURCE_DIR ${STM32F4_SOURCE_DIR}/Drivers/STM32F4xx_HAL_Driver/Src)
SET (STM32F4_BSP_SOURCE_DIR ${STM32F4_SOURCE_DIR}/Drivers/BSP/${PLATFORM_NAME})

SET (PICOVOICE_DIR ${STM32F4_SOURCE_DIR}/Modules/picovoice)
INCLUDE_DIRECTORIES(
 ${CMAKE_CURRENT_SOURCE_DIR}/Inc
 ${STM32F4_SOURCE_DIR}/Common/Inc
 ${STM32F4_SOURCE_DIR}/Drivers/STM32F4xx_HAL_Driver/Inc
 ${STM32F4_SOURCE_DIR}/Drivers/CMSIS/Device/ST/STM32F4xx/Include
 ${STM32F4_SOURCE_DIR}/Drivers/CMSIS/Core/Include
 ${STM32F4_SOURCE_DIR}/Drivers/BSP/${PLATFORM_NAME}
 )

SET( UTILITIES_DIR ${STM32F4_SOURCE_DIR}/Utilities )

SUBDIRS( Common )
SUBDIRS( Drivers )
SUBDIRS( Projects )
